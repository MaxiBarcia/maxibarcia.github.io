---
title: Dvwa - xss (Laboratory) - Low to Impossible
excerpt: Analysis and exploitation of the XSS (Reflected) vulnerability on DVWA's diferent difficulty level.
categories:
  - Write-up
  - Hacking Web
  - Laboratory
tags:
  - methodology
  - dvwa
  - xss
  - reflected-xss
  - Low
  - Medium
  - Hard
  - Impossible
toc: true
toc_label: Report Content
toc_sticky: true
header:
  overlay_image: /assets/images/headers/dvwa-banner.jpg
  overlay_filter: 0.7
  og_image: /assets/images/headers/dvwa-banner.jpg
seo_tittle: DVWA - XSS (Reflected) -
seo_description: A detailed report on the analysis and exploitation of the XSS (Reflected) vulnerability in the DVWA lab, focusing on code injection and cookie theft.
---

![image-center](/assets/images/headers/dvwa-banner.jpg)
{: .align-center}

**Key Skills:**
- **Code Injection:** Injection of malicious payloads.    
- **Filter Bypass:** Techniques for evading blacklists and input sanitization.    
- **Logic Analysis:** Identification of vulnerabilities at different security levels. 

---
### 1. Executive Summary

This report documents the analysis and exploitation of the **Cross-Site Scripting (XSS)** reflected vulnerability in the DVWA web application, covering the **`Low`**, **`Medium`**, **`Hard`**, and **`Impossible`** difficulty levels. The application fails to consistently sanitize or encode user input, which allows for the injection of JavaScript code. This report demonstrates how an attacker can adapt their payloads to circumvent progressively more complex defenses, highlighting the need for robust output sanitization as the only reliable solution.

---

### 2. Introduction

This ethical hacking exercise was conducted on the DVWA platform, an intentionally vulnerable web application. The objective was to explore how the same XSS vulnerability can be exploited at different security levels. This report details the bypass techniques used, starting with a simple injection and advancing to more sophisticated methods to evade security filters, unifying the methodology into a single document to optimize analysis and presentation.

---

### 3. Exploitation

The vulnerability is located in the `XSS (Reflected)` section of DVWA. Below are the payloads and bypass techniques used for each difficulty level.

#### 3.1. Difficulty Level: `Low`
At this level, the application has no security measures. User input is reflected directly in the page's HTML without validation or sanitization.
- **Payload:** The simplest payload is sufficient.
    

```js
<script>alert("XSS")</script>
```

 ![[Pasted image 20250901205431.png|500]]    


![XSS Alert Low](/assets/images/posts/DVWA/xss-js-low.png)

#### 3.2. Difficulty Level: `Medium`

The application now has a security measure: it filters the text string `<script>`. However, this filter is a basic blacklist that is easily bypassable. An attacker can use other HTML tags and events to execute JavaScript.

- **Bypass Technique:** Use an image tag (`<img>`) with an error event (`onerror`) that executes the code. If the image fails to load (e.g., because the URL is incorrect), the event will trigger.
    
- **Payload:**
    


```js
<img src="x" onerror="alert('XSS')">
```
![XSS Alert Medium](/assets/images/posts/DVWA/xss-js-medium.png)
![[Pasted image 20250901211258.png|500]]
#### 3.3. Difficulty Level: `Hard`

At the `Hard` level, the application improves its filter. Now, both the `<script>` string and the `on` string are filtered from the input. To overcome this defense, more advanced techniques are needed.

- **Bypass Technique:** Use a combination of uppercase and lowercase letters or character encoding to evade the filter that looks for the literal `on` string.
    
- **Payload:** The same image technique can be used, but with uppercase letters in the event to bypass the filter.
    


```js
<img src="x" OnError="alert('XSS')">
```

![[Pasted image 20250901211526.png|500]]

#### 3.4. Difficulty Level: `Impossible`

At the `Impossible` level, the application implements **robust output sanitization**. No matter what payload is entered, the application encodes the special characters (`<`, `>`, `"`, etc.) before they are displayed on the page. This prevents the browser from interpreting them as HTML or JavaScript code.

- **Defense Analysis:**
    
    - The application uses PHP's `htmlspecialchars()` function, which converts special characters into their HTML entities.
        
    - For example, `<` is converted to `&lt;` and `>` is converted to `&gt;`.
        
    - This encoding makes any XSS payload harmless, as the browser renders it as plain text instead of executable code.
        

---

### 4. Conclusion and Recommendations

#### Vulnerability Summary

|Vulnerability|Severity|Impact|**CVSS Score**|
|---|---|---|---|
|**XSS (Reflected)**|**Medium**|An attacker can execute arbitrary code in the victim's browser, compromising their session or stealing data.|**4.6 (CVSS v3.1)**|


#### Recommendations for Mitigation

1. **Input Validation:** Do not trust user input. Implement strict server-side validation.
    
2. **Output Encoding:** This is the most important defense. Encode all special characters (`<`, `>`, `"`, etc.) before they are rendered on the page. This prevents the browser from interpreting them as HTML or JavaScript code.
    
3. **Robust Filtering:** Avoid blacklists. Instead, use whitelists to allow only safe content.
    
4. **Use of CSP (Content Security Policy):** Implement a CSP to restrict the sources of scripts and other resources, mitigating the attacker's ability to execute arbitrary code.